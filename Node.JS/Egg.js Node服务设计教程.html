<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Joey Studio</title>
    <meta name="description" content="Joey Studio">
    <link rel="icon" href="/icon.png">
    
    <link rel="preload" href="/assets/css/0.styles.fb6ef450.css" as="style"><link rel="preload" href="/assets/js/app.6496ed3f.js" as="script"><link rel="preload" href="/assets/js/22.439a1331.js" as="script"><link rel="prefetch" href="/assets/js/2.154dcc5e.js"><link rel="prefetch" href="/assets/js/3.2d1485e9.js"><link rel="prefetch" href="/assets/js/4.bff3c410.js"><link rel="prefetch" href="/assets/js/5.dae9ed13.js"><link rel="prefetch" href="/assets/js/6.0e78168f.js"><link rel="prefetch" href="/assets/js/7.080d07e2.js"><link rel="prefetch" href="/assets/js/8.b51527e8.js"><link rel="prefetch" href="/assets/js/9.47e0dfdd.js"><link rel="prefetch" href="/assets/js/10.df869b81.js"><link rel="prefetch" href="/assets/js/11.ca769e48.js"><link rel="prefetch" href="/assets/js/12.054daf01.js"><link rel="prefetch" href="/assets/js/13.a59e5c03.js"><link rel="prefetch" href="/assets/js/14.0b0c8a1d.js"><link rel="prefetch" href="/assets/js/15.a62e713d.js"><link rel="prefetch" href="/assets/js/16.1f5c82f7.js"><link rel="prefetch" href="/assets/js/17.12cc41fd.js"><link rel="prefetch" href="/assets/js/18.9a24a91a.js"><link rel="prefetch" href="/assets/js/19.f6abe518.js"><link rel="prefetch" href="/assets/js/20.e65b6931.js"><link rel="prefetch" href="/assets/js/21.0b676c70.js"><link rel="prefetch" href="/assets/js/23.ba536dc8.js"><link rel="prefetch" href="/assets/js/24.c320b32b.js"><link rel="prefetch" href="/assets/js/25.3e421fe3.js"><link rel="prefetch" href="/assets/js/26.2231c0ca.js"><link rel="prefetch" href="/assets/js/27.bcc817c1.js"><link rel="prefetch" href="/assets/js/28.c2c3d444.js"><link rel="prefetch" href="/assets/js/29.2ead0a19.js"><link rel="prefetch" href="/assets/js/30.1255fe73.js"><link rel="prefetch" href="/assets/js/31.560e43a1.js"><link rel="prefetch" href="/assets/js/32.4763ce13.js"><link rel="prefetch" href="/assets/js/33.f65b93ac.js"><link rel="prefetch" href="/assets/js/34.503ff2e4.js"><link rel="prefetch" href="/assets/js/35.abff669d.js"><link rel="prefetch" href="/assets/js/36.aa126b1a.js"><link rel="prefetch" href="/assets/js/37.92bebcb1.js"><link rel="prefetch" href="/assets/js/38.c3c64b7f.js"><link rel="prefetch" href="/assets/js/39.d86c8f5e.js"><link rel="prefetch" href="/assets/js/40.17162130.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fb6ef450.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Joey Studio</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/Web/" class="nav-link">工具</a></div><div class="nav-item"><a href="/JVM/" class="nav-link">JVM</a></div><div class="nav-item"><a href="/SpringCloud/" class="nav-link">微服务</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/slowside45" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/Web/" class="nav-link">工具</a></div><div class="nav-item"><a href="/JVM/" class="nav-link">JVM</a></div><div class="nav-item"><a href="/SpringCloud/" class="nav-link">微服务</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/slowside45" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><p>[TOC]</p> <h2 id="框架选型"><a href="#框架选型" aria-hidden="true" class="header-anchor">#</a> 框架选型</h2> <p><img src="https://raw.githubusercontent.com/SunShinewyf/issue-blog/master/assets/technical/20.png" alt></p> <ul><li>基础框架 eggjs：http://eggjs.org/zh-cn/</li> <li>ORM 框架：egg-sequelize：https://github.com/eggjs/egg-sequelize</li> <li>JSON Web Token(JWT)插件 egg-jwt：https://github.com/okoala/egg-jwt</li> <li>权限控制 node_acl：https://github.com/OptimalBits/node_acl</li> <li>邮件发送 nodemailer：https://github.com/nodemailer/nodemailer</li></ul> <h2 id="数据库-orm-设计"><a href="#数据库-orm-设计" aria-hidden="true" class="header-anchor">#</a> 数据库 ORM 设计</h2> <p><strong>安装：</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">npm</span> i --save egg-sequelize
$ <span class="token function">npm</span> <span class="token function">install</span> --save mysql2
</code></pre></div><p><strong>配置：</strong></p> <p>app/config/plugin.js 配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>exports<span class="token punctuation">.</span>sequelize <span class="token operator">=</span> <span class="token punctuation">{</span>
  enable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">package</span><span class="token punctuation">:</span> <span class="token string">&quot;egg-sequelize&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>app/config/config.default.js 配置：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 数据库信息配置</span>
exports<span class="token punctuation">.</span>sequelize <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 数据库类型</span>
  dialect<span class="token punctuation">:</span> <span class="token string">&quot;mysql&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// host</span>
  host<span class="token punctuation">:</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 端口号</span>
  port<span class="token punctuation">:</span> <span class="token string">&quot;3306&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 用户名</span>
  username<span class="token punctuation">:</span> <span class="token string">&quot;root&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 密码</span>
  password<span class="token punctuation">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 数据库名</span>
  database<span class="token punctuation">:</span> <span class="token string">&quot;AEMM&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Model 层：</strong></p> <p>app/db.js：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> uuidv1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;uuid/v1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">generateUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">uuidv1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/-/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">defineModel</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> name<span class="token punctuation">,</span> attributes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">UUID</span> <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">;</span>

  <span class="token keyword">let</span> attrs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> attributes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value <span class="token operator">=</span> attributes<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">.</span>allowNull <span class="token operator">=</span> value<span class="token punctuation">.</span>allowNull <span class="token operator">||</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      attrs<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      attrs<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> value<span class="token punctuation">,</span>
        allowNull<span class="token punctuation">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  attrs<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token punctuation">{</span>
    type<span class="token punctuation">:</span> <span class="token constant">UUID</span><span class="token punctuation">,</span>
    primaryKey<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    defaultValue<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">generateUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> app<span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> attrs<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    createdAt<span class="token punctuation">:</span> <span class="token string">&quot;createdAt&quot;</span><span class="token punctuation">,</span>
    updatedAt<span class="token punctuation">:</span> <span class="token string">&quot;updatedAt&quot;</span><span class="token punctuation">,</span>
    version<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    freezeTableName<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> defineModel <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>app/model/User.js：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../db&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> app <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token constant">INTEGER</span><span class="token punctuation">,</span> <span class="token constant">DATE</span><span class="token punctuation">,</span> <span class="token constant">BOOLEAN</span> <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">.</span>Sequelize<span class="token punctuation">;</span>

  <span class="token keyword">const</span> User <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">defineModel</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> <span class="token string">&quot;users&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    username<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> unique<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> allowNull<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 用户名</span>
    email<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> unique<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> allowNull<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 邮箱</span>
    password<span class="token punctuation">:</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> allowNull<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 密码</span>
    name<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 姓名</span>
    sex<span class="token punctuation">:</span> <span class="token constant">INTEGER</span><span class="token punctuation">,</span> <span class="token comment">// 用户性别：1男性, 2女性, 0未知</span>
    age<span class="token punctuation">:</span> <span class="token constant">INTEGER</span><span class="token punctuation">,</span> <span class="token comment">// 年龄</span>
    avatar<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 头像</span>
    company<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 公司</span>
    department<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 部门</span>
    telePhone<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 联系电话</span>
    mobilePhone<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 手机号码</span>
    info<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 备注说明</span>
    roleId<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 角色id</span>
    status<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 用户状态</span>
    token<span class="token punctuation">:</span> <span class="token constant">STRING</span><span class="token punctuation">,</span> <span class="token comment">// 认证 token</span>
    lastSignInAt<span class="token punctuation">:</span> <span class="token constant">DATE</span> <span class="token comment">// 上次登录时间</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> User<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="restful-api-用户认证设计"><a href="#restful-api-用户认证设计" aria-hidden="true" class="header-anchor">#</a> restful API 用户认证设计</h2> <p> 请求头：</p> <div class="language- extra-class"><pre class="language-text"><code>X-AmebaCloud-AppId: {your app id}
X-AmebaCloud-AppKey: {you app key}
X-AmebaCloud-ApiVersion: {ameba cloud service version}
X-AmebaCloud-ChannelId:{channelId}
Authorization: Bearer {access_token}
</code></pre></div><p>注：access_token 为登录后返回的 token 值。</p> <p>返回值：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;描述信息&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>egg-jwt 基于 <a href="https://github.com/auth0/node-jsonwebtoken" target="_blank" rel="noopener noreferrer">node-jsonwebtoken<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 实现，完整文档可以参考 <a href="https://github.com/auth0/node-jsonwebtoken" target="_blank" rel="noopener noreferrer">https://github.com/auth0/node-jsonwebtoken<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。jwt 对象挂载在 app 对象下，可以通过 app.jwt 访问 jwt 的三个方法：</p> <ul><li>jwt.sign(payload, secretOrPrivateKey, [options, callback])————生成 token 字符串</li> <li>jwt.verify(token, secretOrPublicKey, [options, callback])————校验 token 合法性</li> <li>jwt.decode(token [, options])————token 译码</li></ul> <p><strong>安装：</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">npm</span> i egg-jwt --save
</code></pre></div><p><strong>配置：</strong></p> <p>app/config/plugin.js 配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>exports<span class="token punctuation">.</span>jwt <span class="token operator">=</span> <span class="token punctuation">{</span>
  enable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">package</span><span class="token punctuation">:</span> <span class="token string">&quot;egg-jwt&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>app/config/config.default.js 配置：</p> <div class="language-js extra-class"><pre class="language-js"><code>exports<span class="token punctuation">.</span>jwt <span class="token operator">=</span> <span class="token punctuation">{</span>
  enable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  secret<span class="token punctuation">:</span> <span class="token string">&quot;xxxxxxxxxxxxx&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="用户权限设计"><a href="#用户权限设计" aria-hidden="true" class="header-anchor">#</a> 用户权限设计</h2> <p>基于用户的权限管理：</p> <p>假如做权限管理功能的时候都依赖基于用户的权限管理，那么一旦产生变化就会发现这种实现方式的局限性。基于角色的权限管理：「权限」的作用是用来区分某一数据是否允许某种角色的用户进行操作。「权限」只和「角色」对应，而用户也和「角色」对应，为用户赋予角色，然后管理角色的权限，完成了权限与用户的解耦。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;*&quot;</span><span class="token punctuation">:</span><span class="token punctuation">{</span>
    <span class="token string">&quot;read&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string">&quot;write&quot;</span><span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>参考：</p> <ul><li>https://leancloud.cn/docs/acl-guide.html#hash-180328360</li> <li>https://github.com/OptimalBits/node_acl</li> <li>https://github.com/eggjs/egg-userrole</li></ul> <h2 id="异常统计"><a href="#异常统计" aria-hidden="true" class="header-anchor">#</a> 异常统计</h2> <p>stacktrace-js: https://github.com/stacktracejs/stacktrace.js</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/22.439a1331.js" defer></script><script src="/assets/js/app.6496ed3f.js" defer></script>
  </body>
</html>
