<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Joey Studio</title>
    <meta name="description" content="Joey Studio">
    <link rel="icon" href="/icon.png">
    
    <link rel="preload" href="/assets/css/0.styles.fb6ef450.css" as="style"><link rel="preload" href="/assets/js/app.90032a51.js" as="script"><link rel="preload" href="/assets/js/15.a8ebaf23.js" as="script"><link rel="prefetch" href="/assets/js/2.5a98a6a1.js"><link rel="prefetch" href="/assets/js/3.b5328e1b.js"><link rel="prefetch" href="/assets/js/4.40de6c06.js"><link rel="prefetch" href="/assets/js/5.a7dcf9c5.js"><link rel="prefetch" href="/assets/js/6.f937cbb4.js"><link rel="prefetch" href="/assets/js/7.c4f7c54b.js"><link rel="prefetch" href="/assets/js/8.5d6c7a02.js"><link rel="prefetch" href="/assets/js/9.a356cbd1.js"><link rel="prefetch" href="/assets/js/10.ad74828c.js"><link rel="prefetch" href="/assets/js/11.febff9ad.js"><link rel="prefetch" href="/assets/js/12.965a7db6.js"><link rel="prefetch" href="/assets/js/13.ff464b4a.js"><link rel="prefetch" href="/assets/js/14.77211fa2.js"><link rel="prefetch" href="/assets/js/16.1c808406.js"><link rel="prefetch" href="/assets/js/17.eb2609ad.js"><link rel="prefetch" href="/assets/js/18.a57c4dcb.js"><link rel="prefetch" href="/assets/js/19.45de9095.js"><link rel="prefetch" href="/assets/js/20.3890a0dc.js"><link rel="prefetch" href="/assets/js/21.12c4cf59.js"><link rel="prefetch" href="/assets/js/22.83f70874.js"><link rel="prefetch" href="/assets/js/23.6912cfc1.js"><link rel="prefetch" href="/assets/js/24.547c12d4.js"><link rel="prefetch" href="/assets/js/25.ea4c2b82.js"><link rel="prefetch" href="/assets/js/26.9137f71d.js"><link rel="prefetch" href="/assets/js/27.769a107f.js"><link rel="prefetch" href="/assets/js/28.d0a482c4.js"><link rel="prefetch" href="/assets/js/29.860aeae4.js"><link rel="prefetch" href="/assets/js/30.fe511a2a.js"><link rel="prefetch" href="/assets/js/31.6ab4ce31.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fb6ef450.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Joey Studio</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/Web/" class="nav-link">工具</a></div><div class="nav-item"><a href="/SpringCloud/" class="nav-link">微服务</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/slowside45" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/Web/" class="nav-link">工具</a></div><div class="nav-item"><a href="/SpringCloud/" class="nav-link">微服务</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/slowside45" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><p>[TOC]</p> <h2 id="router的使用"><a href="#router的使用" aria-hidden="true" class="header-anchor">#</a> Router的使用</h2> <h4 id="一、restful-api的crud"><a href="#一、restful-api的crud" aria-hidden="true" class="header-anchor">#</a> 一、RESTful API的CRUD</h4> <div class="language- extra-class"><pre class="language-text"><code> router.resources(&quot;router&quot;, &quot;url&quot;, controller)；
</code></pre></div><ul><li><p><em>参数说明</em></p> <ul><li><strong>router</strong>：路由的名称，这个属性只是为了辨识，没有特定的key-value关系</li> <li><strong>url</strong>: 遵循RESTful API 规范设计的API的url值</li> <li><strong>controller</strong>： 最外层controller的url值</li></ul></li> <li><p><em>RESTful API 的controller</em></p></li></ul> <ol><li>在部署了sequelize插件的egg.js框架中，controller的调用顺序为：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>graph LR
A[最外层Controller] --&gt; B[service中的controller]
B --&gt; C[model类中sequelize插件封装好的controller]
</code></pre></div><ol start="2"><li>在最外层Controller中，有框架预封装好的CRUD方法，如果需要使用它们， 只需要在controller文件中显示声明即可.</li></ol> <ul><li>Eg:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>router.resources('users', 'api/v1/users', controller.v1.users);
</code></pre></div><p>以下方法自动生成，若不需要，不显示声明即可</p> <div class="language- extra-class"><pre class="language-text"><code>graph LR
A[create] --&gt; B[POST   /api/v1/users]
I[index] --&gt; J[GET /api/v1/users]
K[new] --&gt; L[GET /api/v1/users/new]
C[show] --&gt; D[GET /api/v1/users/:id]
M[edit] --&gt; N[GET /api/v1/users/:id/edit]
E[delete] --&gt; F[DELETE /api/v1/users/:id]
G[update] --&gt; H[PUT /api/v1/users/:id]

</code></pre></div><hr> <h4 id="二、中间件的使用"><a href="#二、中间件的使用" aria-hidden="true" class="header-anchor">#</a> 二、中间件的使用</h4> <div class="language- extra-class"><pre class="language-text"><code>router.&lt;method&gt;(&lt;api&gt;,&lt;middleware&gt;,&lt;controller&gt;);
</code></pre></div><ul><li>method: HTTP Method</li> <li>api: 根据需要设置的api的url的值</li> <li>middleware：路由中要加载的中间件的的文件名，去掉 _ （如果需要使用多个中间件，用逗号分隔来实现串联的效果）</li> <li>controller: 控制器的url</li></ul> <hr> <h4 id="三、router-——-参数获取"><a href="#三、router-——-参数获取" aria-hidden="true" class="header-anchor">#</a> 三、Router —— 参数获取</h4> <p>(1). 获取url中的参数</p> <ul><li>命名参数，使用ctx.params.id来获取</li> <li>查询字符串，使用ctx.query.&lt;变量名&gt;来获取</li> <li>正则表达式，使用ctx.params来获取</li></ul> <div class="language- extra-class"><pre class="language-text"><code>module.exports = app =&gt; {
    app.router.get('/user/:id/:name', app.controller.user.info) // id和name都是命名参数，使用ctx.params.id方式获取
    app.router.get('/search', app.controller.search.index) // 对于search?name=xxx，使用ctx.query.name获取
}
</code></pre></div><p>(2). 获取表单的参数</p> <ul><li>表单参数的获取，可以通过ctx.request.body获取，如：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// app/controller/form.js
exports.post = async ctx =&gt; {
    ctx.body = `Body: ${JSON.stringify(ctx.request.body)}`
}
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/15.a8ebaf23.js" defer></script><script src="/assets/js/app.90032a51.js" defer></script>
  </body>
</html>
