<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Springboot 排坑日志 | Joey Studio</title>
    <meta name="description" content="Joey Studio">
    <link rel="icon" href="/icon.png">
    
    <link rel="preload" href="/assets/css/0.styles.fb6ef450.css" as="style"><link rel="preload" href="/assets/js/app.90032a51.js" as="script"><link rel="preload" href="/assets/js/30.fe511a2a.js" as="script"><link rel="prefetch" href="/assets/js/2.5a98a6a1.js"><link rel="prefetch" href="/assets/js/3.b5328e1b.js"><link rel="prefetch" href="/assets/js/4.40de6c06.js"><link rel="prefetch" href="/assets/js/5.a7dcf9c5.js"><link rel="prefetch" href="/assets/js/6.f937cbb4.js"><link rel="prefetch" href="/assets/js/7.c4f7c54b.js"><link rel="prefetch" href="/assets/js/8.5d6c7a02.js"><link rel="prefetch" href="/assets/js/9.a356cbd1.js"><link rel="prefetch" href="/assets/js/10.ad74828c.js"><link rel="prefetch" href="/assets/js/11.febff9ad.js"><link rel="prefetch" href="/assets/js/12.965a7db6.js"><link rel="prefetch" href="/assets/js/13.ff464b4a.js"><link rel="prefetch" href="/assets/js/14.77211fa2.js"><link rel="prefetch" href="/assets/js/15.a8ebaf23.js"><link rel="prefetch" href="/assets/js/16.1c808406.js"><link rel="prefetch" href="/assets/js/17.eb2609ad.js"><link rel="prefetch" href="/assets/js/18.a57c4dcb.js"><link rel="prefetch" href="/assets/js/19.45de9095.js"><link rel="prefetch" href="/assets/js/20.3890a0dc.js"><link rel="prefetch" href="/assets/js/21.12c4cf59.js"><link rel="prefetch" href="/assets/js/22.83f70874.js"><link rel="prefetch" href="/assets/js/23.6912cfc1.js"><link rel="prefetch" href="/assets/js/24.547c12d4.js"><link rel="prefetch" href="/assets/js/25.ea4c2b82.js"><link rel="prefetch" href="/assets/js/26.9137f71d.js"><link rel="prefetch" href="/assets/js/27.769a107f.js"><link rel="prefetch" href="/assets/js/28.d0a482c4.js"><link rel="prefetch" href="/assets/js/29.860aeae4.js"><link rel="prefetch" href="/assets/js/31.6ab4ce31.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fb6ef450.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Joey Studio</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/Web/" class="nav-link router-link-active">工具</a></div><div class="nav-item"><a href="/SpringCloud/" class="nav-link">微服务</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/slowside45" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/Web/" class="nav-link router-link-active">工具</a></div><div class="nav-item"><a href="/SpringCloud/" class="nav-link">微服务</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于我</a></div><div class="nav-item"><a href="https://github.com/slowside45" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Web/" class="sidebar-link">Springboot</a></li><li><a href="/Web/JetBrain-getKey.html" class="sidebar-link">获取JetBrain全家桶三个月续期</a></li><li><a href="/Web/learn-springboot.html" class="active sidebar-link">Springboot 排坑日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Web/learn-springboot.html#service-无法通过-autowired-方式依赖注入" class="sidebar-link">Service 无法通过@Autowired 方式依赖注入</a></li><li class="sidebar-sub-header"><a href="/Web/learn-springboot.html#配置文件参数读取" class="sidebar-link">配置文件参数读取</a></li><li class="sidebar-sub-header"><a href="/Web/learn-springboot.html#springboot-常用配置" class="sidebar-link">SpringBoot 常用配置</a></li><li class="sidebar-sub-header"><a href="/Web/learn-springboot.html#参数校验-validate-注解" class="sidebar-link">参数校验(Validate 注解)</a></li></ul></li><li><a href="/Web/SpringbootErrorFallback.html" class="sidebar-link">Springboot 项目开发常见错误</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="springboot-排坑日志"><a href="#springboot-排坑日志" aria-hidden="true" class="header-anchor">#</a> Springboot 排坑日志</h1> <h2 id="service-无法通过-autowired-方式依赖注入"><a href="#service-无法通过-autowired-方式依赖注入" aria-hidden="true" class="header-anchor">#</a> Service 无法通过@Autowired 方式依赖注入</h2> <p>当出现如下报错时：</p> <div class="language- extra-class"><pre class="language-text"><code>Action:
Consider defining a bean of type 'seconds47.service.TopicService' in your configuration.

Description:
Field topicService in seconds47.restAPI.topics required a bean of type 'seconds47.service.TopicService' that could not be found
</code></pre></div><ul><li>解决办法：</li></ul> <p>在运行类加入注解：@ComponentScan(value={&quot;xx.xx.xx&quot;,&quot;xx,xx,xx&quot;})，把 service、controller、repository 等文件的包都引进来，就能解决</p> <h2 id="配置文件参数读取"><a href="#配置文件参数读取" aria-hidden="true" class="header-anchor">#</a> 配置文件参数读取</h2> <h3 id="一、注解方式读取"><a href="#一、注解方式读取" aria-hidden="true" class="header-anchor">#</a> 一、注解方式读取</h3> <ol><li>@PropertySource 配置文件路径设置，在类上添加注解，如果在默认路径下可以不添加该注解。
需要用@PropertySource 的有：</li></ol> <p>例如非 application.properties，classpath:config/my.properties 指的是 src/main/resources 目录下 config 目录下的 my.properties 文件，
例如有多配置文件引用，若两个配置文件中有相同属性名的值，则取值为最后一个配置文件中的值
在 application.properties 中的文件，直接使用@Value 读取即可，application 的读取优先级最高
@PropertySource({&quot;classpath:config/my.properties&quot;,&quot;classpath:config/config.properties&quot;})
public class cn.com.test.TestController</p> <ol start="2"><li><p>@Value 属性名，在属性名上添加该注解
@Value(&quot;${my.name}&quot;)
private String myName;</p></li> <li><p>使用 mysql 8.0 时，jdbc 驱动包需要使用<code>com.mysql.cj.jdbc.Driver</code></p></li> <li><p>入口类需要放在一个自定义的 package 内，否则会报错</p></li> <li><p><code>@ComponentScan</code>注解的使用：入口类如果和 bean、controller 等类在同一个包下，则不用单独申明，如果不在同一包下，需要单独声明，扫描其他包下的 controller、bean 等，从而进行依赖注入，例：</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>@ComponentScan({&quot;com.agree.controller&quot;,&quot;com.agree.entity&quot;,&quot;com.agree.repository&quot;,&quot;com.agree.service&quot;})
</code></pre></div><ol start="4"><li>连接数据库时，发生<code>Access Denined</code>的错误：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>properties方式配置的话，只要填写正确的用户名和密码，一般不会出错。如果在yml中进行配置，需要在数据库密码两边加上&quot;&quot;
</code></pre></div><ul><li>错误配置：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>spring:
  datasource:
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&amp;characterSetResults=utf8&amp;useSSL=false
    username: root
    password: 000000
</code></pre></div><ul><li>正确配置：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>spring:
  datasource:
    driver-class-name: com.mysql.jdbc.Driver
    url: jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&amp;characterSetResults=utf8&amp;useSSL=false
    username: root
    password: &quot;000000&quot;
</code></pre></div><h2 id="springboot-常用配置"><a href="#springboot-常用配置" aria-hidden="true" class="header-anchor">#</a> SpringBoot 常用配置</h2> <h3 id="requestbody-注解的注意事项"><a href="#requestbody-注解的注意事项" aria-hidden="true" class="header-anchor">#</a> @RequestBody 注解的注意事项</h3> <ol><li>@RequestBody 需要把所有请求参数作为 json 解析，因此，不能包含 key=value 这样的写法在请求 url 中，所有的请求参数都是一个 json</li> <li>直接通过浏览器输入 url 时，@RequestBody 获取不到 json 对象，需要用 java 编程或者基于 ajax 的方法请求，将 Content-Type 设置为 application/json</li></ol> <h3 id="常用的-25-个注解："><a href="#常用的-25-个注解：" aria-hidden="true" class="header-anchor">#</a> 常用的 25 个注解：</h3> <p><a href="https://www.jianshu.com/p/2be4524fe5a8?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation" target="_blank" rel="noopener noreferrer">常用注解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="spring-boot-中的配置文件："><a href="#spring-boot-中的配置文件：" aria-hidden="true" class="header-anchor">#</a> Spring Boot 中的配置文件：</h3> <div class="language- extra-class"><pre class="language-text"><code>server.port=9090 # 服务端口号
server.tomcat.uri-encoding=UTF-8 #以Tomcat为web容器时的字符编码
spring.data.mongodb.uri=mongodb://localhost:27017/mydb #mongodb连接

spring.application.name=customer # 应用名称，一般就是项目名称，这个名称在SpringCloud中比较关键
spring.profiles.active=dev #指定当前的活动配置文件，主要用于多环境多配置文件的应用中
spring.http.encoding.charset=UTF-8 #http请求的字符编码
spring.http.multipart.max-file-size=10MB #设置文件上传时单个文件的大小限制
spring.http.multipart.max-request-size=100MB #设置文件上传时总文件大小限制

spring.mvc.static-path-pattern=/** #设置静态资源的请求路径
spring.resources.static-locations=classpath:/static/,classpath:/public/ #指定静态资源的路径

##以下是使用MySQL数据库的配置
hibernate.dialect=org.hibernate.dialect.MySQL5Dialect #指定数据库方言
hibernate.show_sql=true #是否显示sql语句
hibernate.hbm2dll.auto=update #设置使用Hibernate的自动建表方式
entitymanager.packagesToScan=com.zslin #设置自动扫描的包前缀

spring.datasource.url=jdbc:mysql://localhost:3306/customer?\
useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true&amp;autoReconnect=true #数据库链接
spring.datasource.username=root #数据库用户名
spring.datasource.password=123 #数据库用户对应的密码
spring.datasource.driver-class-name=com.mysql.jdbc.Driver #数据库驱动名称

</code></pre></div><h2 id="参数校验-validate-注解"><a href="#参数校验-validate-注解" aria-hidden="true" class="header-anchor">#</a> 参数校验(Validate 注解)</h2> <table><thead><tr><th>注解名</th> <th>用法</th></tr></thead> <tbody><tr><td>@Null</td> <td>验证对象是否为空</td></tr> <tr><td>@NotNull</td> <td>验证对象是否为非空</td></tr> <tr><td>@AssertTrue</td> <td>验证 boolean 对象是否为 true</td></tr> <tr><td>@AssertFalse</td> <td>验证 boolean 对象是否为 false</td></tr> <tr><td>@Min</td> <td>验证 number 和 string 对象是否大等于指定的值</td></tr> <tr><td>@Max</td> <td>验证 number 和 string 对象是否小等于指定的值</td></tr> <tr><td>@DecimalMin</td> <td>验证 number 和 string 对象是否大等于指定的值，小数存在精度</td></tr> <tr><td>@FecimalMax</td> <td>验证 number 和 string 对象是否小等于指定的值，小数存在精度</td></tr> <tr><td>@Size</td> <td>验证对象（array,collection,map,string）长度是否在给定的范围之内</td></tr> <tr><td>@Digits</td> <td>验证 number 和 string 的构成是否合法</td></tr> <tr><td>@Last</td> <td>验证 date 和 calendar 对象是否在当前时间之前</td></tr> <tr><td>@Future</td> <td>验证 date 和 calendar 对象是否在当前时间之后</td></tr> <tr><td>@Pattern</td> <td>验证 string 对象是否符合正则表达式的规则</td></tr> <tr><td>@Email</td> <td>验证邮箱</td></tr></tbody></table> <ul><li>举例</li></ul> <div class="language-Java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> max<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">&quot;用户名长度只能在3-20之间&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@pattern</span> <span class="token punctuation">(</span>regexp<span class="token operator">=</span><span class="token string">&quot;[a-za-z0-9._%+-]+@[a-za-z0-9.-]+\\.[a-za-z]{2,4}&quot;</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">&quot;邮件格式错误&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Length</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;用户名长度必须位于5到20之间&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;比如输入正确的邮箱&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;用户名称不能为空&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Max</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;年龄不能大于100岁&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value<span class="token operator">=</span> <span class="token number">18</span> <span class="token punctuation">,</span>message<span class="token operator">=</span> <span class="token string">&quot;必须年满18岁！&quot;</span> <span class="token punctuation">)</span>
    <span class="token annotation punctuation">@AssertTrue</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;bln4 must is true&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@AssertFalse</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;blnf must is falase&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@DecimalMax</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;100&quot;</span><span class="token punctuation">,</span>message<span class="token operator">=</span><span class="token string">&quot;decim最大值是100&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@DecimalMin</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">&quot;100&quot;</span><span class="token punctuation">,</span>message<span class="token operator">=</span><span class="token string">&quot;decim最小值是100&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Pattern</span><span class="token punctuation">(</span>regexp<span class="token operator">=</span><span class="token string">&quot;^(\\d{18,18}|\\d{15,15}|(\\d{17,17}[x|X]))$&quot;</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">&quot;身份证格式错误&quot;</span><span class="token punctuation">)</span>
</code></pre></div><span id="redis">
...
</span> <h1 id="redis-排坑日志"><a href="#redis-排坑日志" aria-hidden="true" class="header-anchor">#</a> Redis 排坑日志</h1> <ol><li>在命令行中配置 requirepass(访问数据库所需的密码)，有时候不会生效，需要到 Redis 根目录下，在<code>redis.windows.conf</code>文件中加入 requirepass.</li> <li>Redis 不要安装在 C 盘，否则在连接时会出现 Access Denied 的错误</li> <li>在本地启动 redis 服务时，有两种启动方式：</li></ol> <ul><li>第一种： redis-server（不建议）</li></ul> <div class="language-$xslt extra-class"><pre class="language-text"><code>这种启动方式，默认不带密码，如此情况下，客户端发送了一个带密码的请求，服务端没有设置密码校验，会导致报错
</code></pre></div><ul><li>第二种：redis-server redis.windows.conf</li></ul> <div class="language-$xslt extra-class"><pre class="language-text"><code>需要事先在redis.windows.conf配置文件中加入requirepass，再按照这种方式启动，就不会有报错
</code></pre></div><h1 id="oracle-排坑日志"><a href="#oracle-排坑日志" aria-hidden="true" class="header-anchor">#</a> Oracle 排坑日志</h1> <ol><li>在 Springboot 的实体类中，Table 注解的值加上双引号后会被自动解析成大写。Oracle 数据库对大小写敏感，所以建议表名、字段名均采用大写。</li> <li>实体类的属性如果是小驼峰，会被MyBatis自动解析成带有下划线的形式，传入数据库中，造成错误：</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@TableId</span>
<span class="token keyword">private</span> String id<span class="token punctuation">;</span>
<span class="token keyword">private</span> String weChatId<span class="token punctuation">;</span>
<span class="token keyword">private</span> String userStr<span class="token punctuation">;</span>
<span class="token keyword">private</span> Date createdAt<span class="token punctuation">;</span>

<span class="token comment">// 自动解析后</span>
### SQL<span class="token operator">:</span> INSERT INTO wechatAppExperimenter  <span class="token punctuation">(</span> id<span class="token punctuation">,</span> created_at<span class="token punctuation">,</span> user_str<span class="token punctuation">,</span> we_chat_id <span class="token punctuation">)</span>  VALUES  <span class="token punctuation">(</span> <span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token punctuation">)</span>
### Cause<span class="token operator">:</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLSyntaxErrorException<span class="token operator">:</span> Unknown column <span class="token string">'created_at'</span> in <span class="token string">'field list'</span>
</code></pre></div><ul><li>解决办法：
在application.yml里添加一行配置，关闭驼峰到下划线的映射即可</li></ul> <div class="language-yml extra-class"><pre class="language-text"><code>mybatis-plus.configuration.map-underscore-to-camel-case=false

</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Web/JetBrain-getKey.html" class="prev">
          获取JetBrain全家桶三个月续期
        </a></span> <span class="next"><a href="/Web/SpringbootErrorFallback.html">
          Springboot 项目开发常见错误
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/30.fe511a2a.js" defer></script><script src="/assets/js/app.90032a51.js" defer></script>
  </body>
</html>
