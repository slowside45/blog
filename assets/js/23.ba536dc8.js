(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{332:function(e,r,t){"use strict";t.r(r);var a=t(1),s=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"content"},[t("p",[e._v("[TOC]")]),e._v(" "),t("h2",{attrs:{id:"router的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#router的使用","aria-hidden":"true"}},[e._v("#")]),e._v(" Router的使用")]),e._v(" "),t("h4",{attrs:{id:"一、restful-api的crud"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、restful-api的crud","aria-hidden":"true"}},[e._v("#")]),e._v(" 一、RESTful API的CRUD")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v(' router.resources("router", "url", controller)；\n')])])]),t("ul",[t("li",[t("p",[t("em",[e._v("参数说明")])]),e._v(" "),t("ul",[t("li",[t("strong",[e._v("router")]),e._v("：路由的名称，这个属性只是为了辨识，没有特定的key-value关系")]),e._v(" "),t("li",[t("strong",[e._v("url")]),e._v(": 遵循RESTful API 规范设计的API的url值")]),e._v(" "),t("li",[t("strong",[e._v("controller")]),e._v("： 最外层controller的url值")])])]),e._v(" "),t("li",[t("p",[t("em",[e._v("RESTful API 的controller")])])])]),e._v(" "),t("ol",[t("li",[e._v("在部署了sequelize插件的egg.js框架中，controller的调用顺序为：")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("graph LR\nA[最外层Controller] --\x3e B[service中的controller]\nB --\x3e C[model类中sequelize插件封装好的controller]\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("在最外层Controller中，有框架预封装好的CRUD方法，如果需要使用它们， 只需要在controller文件中显示声明即可.")])]),e._v(" "),t("ul",[t("li",[e._v("Eg:")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("router.resources('users', 'api/v1/users', controller.v1.users);\n")])])]),t("p",[e._v("以下方法自动生成，若不需要，不显示声明即可")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("graph LR\nA[create] --\x3e B[POST   /api/v1/users]\nI[index] --\x3e J[GET /api/v1/users]\nK[new] --\x3e L[GET /api/v1/users/new]\nC[show] --\x3e D[GET /api/v1/users/:id]\nM[edit] --\x3e N[GET /api/v1/users/:id/edit]\nE[delete] --\x3e F[DELETE /api/v1/users/:id]\nG[update] --\x3e H[PUT /api/v1/users/:id]\n\n")])])]),t("hr"),e._v(" "),t("h4",{attrs:{id:"二、中间件的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、中间件的使用","aria-hidden":"true"}},[e._v("#")]),e._v(" 二、中间件的使用")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("router.<method>(<api>,<middleware>,<controller>);\n")])])]),t("ul",[t("li",[e._v("method: HTTP Method")]),e._v(" "),t("li",[e._v("api: 根据需要设置的api的url的值")]),e._v(" "),t("li",[e._v("middleware：路由中要加载的中间件的的文件名，去掉 _ （如果需要使用多个中间件，用逗号分隔来实现串联的效果）")]),e._v(" "),t("li",[e._v("controller: 控制器的url")])]),e._v(" "),t("hr"),e._v(" "),t("h4",{attrs:{id:"三、router-——-参数获取"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、router-——-参数获取","aria-hidden":"true"}},[e._v("#")]),e._v(" 三、Router —— 参数获取")]),e._v(" "),t("p",[e._v("(1). 获取url中的参数")]),e._v(" "),t("ul",[t("li",[e._v("命名参数，使用ctx.params.id来获取")]),e._v(" "),t("li",[e._v("查询字符串，使用ctx.query.<变量名>来获取")]),e._v(" "),t("li",[e._v("正则表达式，使用ctx.params来获取")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("module.exports = app => {\n    app.router.get('/user/:id/:name', app.controller.user.info) // id和name都是命名参数，使用ctx.params.id方式获取\n    app.router.get('/search', app.controller.search.index) // 对于search?name=xxx，使用ctx.query.name获取\n}\n")])])]),t("p",[e._v("(2). 获取表单的参数")]),e._v(" "),t("ul",[t("li",[e._v("表单参数的获取，可以通过ctx.request.body获取，如：")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// app/controller/form.js\nexports.post = async ctx => {\n    ctx.body = `Body: ${JSON.stringify(ctx.request.body)}`\n}\n")])])])])}],!1,null,null,null);s.options.__file="Egg.js学习（一） Router的使用.md";r.default=s.exports}}]);